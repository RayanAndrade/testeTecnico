<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Técnico Rayan</title>
    <script src="js/jquery.js"></script>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <style>
        main{
            height: 100vh;
            background-color: whitesmoke;
        }
        body{
            background-color: rgba(245, 245, 245, 0.9);
            min-width: 480px;
        }
    </style>
</head>
<body >
    <main class="container p-5 text-center d-flex flex-column">
        <div class="row localBase my-auto">
            <div class="col-lg-3 m-auto perguntaInicial">
                <label for="quantidadeNumerosSoma">Insira um número</label>
                <input type="number" class="form-control mb-1" name="quantidadeNumerosSoma" id="quantidadeNumerosSoma">
            </div>

            <div class="col-lg-6 col-md-6 col-sm-12 m-auto clonado d-none">
                <label for="numeroSoma">Insira um número para ser somado</label>
                <input type="number" class="form-control mb-1" name="numeroSoma" id="numeroSoma">
            </div>

            <div class="col-lg-12 m-auto" id="gerarForms">
                <input type="button" class="btn btn-outline-success" value="Gerar" onclick="gerarForms()">
            </div>
        </div>

        <div class="row copiarAqui mb-5"></div>

        <div class="row">
            <div class="col-lg-6 m-auto d-none" id="calcularSoma">
                <input type="button" class="btn btn-block btn-outline-success mb-5 mt-2" value="Calcular" onclick="calcularSoma()">
            </div>

            <div class="col-lg-6 m-auto d-none" id="redefinirForm">
                <input type="button" class="btn btn-block btn-outline-warning mb-5 mt-2" value="Voltar" onclick="redefinirForm()">
            </div>
        </div>
    </main>

    <script>
        const gerarForms = () => {
            let quantidadeNumerosSoma = parseInt($("#quantidadeNumerosSoma").val());
            
            if(quantidadeNumerosSoma){
                for(i = 0; i < quantidadeNumerosSoma; i++){
                 $("div.localBase div.clonado").removeClass("d-none").clone().prependTo(".copiarAqui")
                };

                ($("input#quantidadeNumerosSoma")).val("");
                $("div.perguntaInicial").addClass("d-none");
                $("div.localBase").find("div.clonado").addClass("d-none");
                $("div#gerarForms").addClass("d-none");
                $("div#calcularSoma").removeClass("d-none");
                $("div#redefinirForm").removeClass("d-none");
                $("div.localBase").removeClass("my-auto");
            }else{
                alert("Digite um número válido!!");
                $("#quantidadeNumerosSoma").val("").focus();
                return false;
            }
        };

        const calcularSoma = () => {
            let soma = 0;
            let numeroUsado;
            let validado = true;

            $("div.copiarAqui div.clonado input").each((key, value)=>{
                numeroUsado = $(value).val(); 

                if(numeroUsado){
                    soma += parseInt(numeroUsado);
                }else{
                    validado = false;
                    $(value).val("").focus();
                    return false;
                }
            });
            if(validado){
                alert(`A soma dos números que você digitou é: ${soma}`);
                redefinirForm();
            }else{
                alert("Digite um número válido!!");
            }
        };

        const redefinirForm = () => {
            $("div#gerarForms").removeClass("d-none");
            $("div#calcularSoma").addClass("d-none");
            $("div#redefinirForm").addClass("d-none");
            $("div.localBase").addClass("my-auto");
            $("div.localBase").find("div.clonado").addClass("d-none");
            $("div.perguntaInicial").removeClass("d-none");
            $("div.copiarAqui div.clonado").each((key, value)=>{
                value.remove();
            });
        };
    </script>
</body>
</html>